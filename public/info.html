<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<body>

<!-- Navbar (sit on top) -->
<div class="w3-top">
  <div class="w3-bar w3-white w3-wide w3-padding w3-card">
    <a href="#home" class="w3-bar-item w3-button"><b>COMS 6156</b> ASE Final</a>
    <!-- Float links to the right. Hide them on small screens -->
    <div class="w3-right w3-hide-small">
      <a href="#contact" class="w3-bar-item w3-button">Profile</a>
      <a href="#about" class="w3-bar-item w3-button">About</a>
    </div>
  </div>
</div>

<!-- Header -->
<header>
  <img src="../photo/bulter2.jpg" width="800" length = "800">

</header>

<!-- Page content -->
<div class="w3-content w3-padding" style="max-width:1564px">

 <!-- Profile Section -->
 <div class="w3-container w3-padding-32" id="contact">
   <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Profile</h3>

   <!-- <td ><label>Username:</label></td>
   <textarea id="p2">Hello World!</textarea> -->



    <table id="login">
            <tr>
                <td ><label>Username:</label></td>
            </tr>
            <tr>
                <td colspan="2"><textarea id="p2" readonly="true">Hello World!</textarea></td>
            </tr>
            <tr>
                <td><label>Gender</label></td>
            </tr>
            <tr>
                <td colspan="2"><textarea id="gender" readonly="true"></textarea></td>
            </tr>
            <tr>
                <td ><label>Age</label></td>
            </tr>
            <tr>
                <td colspan="2"><textarea id="age" readonly="true"></textarea></td>
            </tr>
            <tr>
                <td><label>Phone</label></td>
            </tr>
            <tr>
                <td colspan="2"><textarea id="phone" readonly="true"></textarea></td>
            </tr>
            <tr>
                <td><label>Address</label></td>
            </tr>
            <tr>
                <td colspan="2"><textarea id="address" readonly="true"></textarea></td>
            </tr>
            <tr>
                <td><input type="button" class="loginButtons" value="Edit" onclick="edit()"></td>
            </tr>
        </table>
  </div>


   <!-- About Section -->
   <div class="w3-container w3-padding-32" id="about">
     <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">About</h3>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Excepteur sint
      occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
      laboris nisi ut aliquip ex ea commodo consequat.
    </p>
  </div>

  <div class="w3-row-padding w3-grayscale">
    <div class="w3-col l3 m6 w3-margin-bottom">
      <img src="/w3images/team2.jpg" alt="John" style="width:100%">
      <h3>John Doe</h3>
      <p class="w3-opacity">CEO & Founder</p>
      <p>Phasellus eget enim eu lectus faucibus vestibulum. Suspendisse sodales pellentesque elementum.</p>
      <p><button class="w3-button w3-light-grey w3-block">Contact</button></p>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <img src="/w3images/team1.jpg" alt="Jane" style="width:100%">
      <h3>Jane Doe</h3>
      <p class="w3-opacity">Architect</p>
      <p>Phasellus eget enim eu lectus faucibus vestibulum. Suspendisse sodales pellentesque elementum.</p>
      <p><button class="w3-button w3-light-grey w3-block">Contact</button></p>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <img src="/w3images/team3.jpg" alt="Mike" style="width:100%">
      <h3>Mike Ross</h3>
      <p class="w3-opacity">Architect</p>
      <p>Phasellus eget enim eu lectus faucibus vestibulum. Suspendisse sodales pellentesque elementum.</p>
      <p><button class="w3-button w3-light-grey w3-block">Contact</button></p>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <img src="/w3images/team4.jpg" alt="Dan" style="width:100%">
      <h3>Dan Star</h3>
      <p class="w3-opacity">Architect</p>
      <p>Phasellus eget enim eu lectus faucibus vestibulum. Suspendisse sodales pellentesque elementum.</p>
      <p><button class="w3-button w3-light-grey w3-block">Contact</button></p>
    </div>
  </div>
<!-- Image of location/map -->
<div class="w3-container">
  <img src="/w3images/map.jpg" class="w3-image" style="width:100%">
</div>

<!-- End page content -->
</div>


<!-- Footer -->
<footer class="w3-center w3-black w3-padding-16">
  <p>Columbia University COMS6156 2018 FALL</p>
</footer>

</body>

<script src="https://sdk.amazonaws.com/js/aws-sdk-2.283.1.min.js"></script>
<script>
  function inputBody(body){
        console.log(body);
        axios.post('https://uvf9clstk8.execute-api.us-east-1.amazonaws.com/login/profile', {
            username: body.username,
            gender: body.gender,
            age: body.age,
            phone: body.phone,
            address: body.address
        }); 
  };

  function getBody(username){
    axios.get(`https://uvf9clstk8.execute-api.us-east-1.amazonaws.com/login/profile/${username}`)
    .then(function (response) {
        console.log(response);
        if (response.data === null) {
          console.log("null");
          document.getElementById("gender").innerHTML = "";
          document.getElementById("age").innerHTML = "";
          document.getElementById("phone").innerHTML = "";
          document.getElementById("address").innerHTML = "";
          let data = {
            username: username,
            gender: " ",
            age: " ",
            phone: " ",
            address: " "
          };
          inputBody(data);
        } else {
          data = response.data;
          document.getElementById("gender").innerHTML = data.gender;
          document.getElementById("age").innerHTML = data.age;
          document.getElementById("phone").innerHTML = data.phone;
          document.getElementById("address").innerHTML = data.address;
          console.log(data);
        }
    })
    .catch(function (error) {
      console.log(error);
    });
}
</script>
<script>
      function get_info(){
        AWS.config.update({region: 'us-east-1', accessKeyId:"AKIAJVHWKMZVJQBSYXZA", secretAccessKey:"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"});
        ddb = new AWS.DynamoDB({apiVersion: '2012-10-08'});
        var token = "";
        var type = "";
        if (sessionStorage.getItem("google-token")) {
          token = sessionStorage.getItem("google-token");
          type = "google";
        } else {
          token = sessionStorage.getItem("access-token");
          type = "normal";
        }
        
        if (type === "google") {
          $.ajax({
            type: "POST",
            url: "http://furniture-dev.us-east-1.elasticbeanstalk.com/users/tokensignin",
            // url: "http://localhost:3000/users/tokensignin",
            contentType: "application/json",
            data: JSON.stringify({token: token}),
            error: function(e){
              console.log(e);
              alert("Something wrong in google");
            },
            success:function(data){
              console.log(data);
              username = data.username;
              window.sessionStorage.setItem("user", username);
              document.getElementById("p2").innerHTML = username;
              
              // inputBody({"username": username});

              getBody(username);
            }
        });
      } else {
        $.ajax({
          type: "POST",
          url: "http://furniture-dev.us-east-1.elasticbeanstalk.com/users/verify",
          // url: "http://localhost:3000/users/verify",
          contentType: "application/json",
          data: JSON.stringify({token: token, type:type}),
          error: function(e){
            console.log(e);
            alert("Token wrong!");
          },
          success:function(data){
            username = data.username;
            window.sessionStorage.setItem("user", username);
            document.getElementById("p2").innerHTML = username;
            
            // inputBody({"username": username, });
            getBody(username);
          }
        });
      }
    };
    get_info();
</script>

<script>
  function edit() {
    window.location.href = "editInfo.html";
  }
</script>

</html>
